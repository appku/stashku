<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    
    <title>@AppKu/StashKu: engines/memory-engine.js</title>
    
    
      <link type="text/css" rel="stylesheet" href="styles/vendor/prism-tomorrow-night.css">
    
    <link type="image/x-icon" rel="icon" href="favicon.ico">
    <link type="image/x-icon" rel="shortcut icon" href="favicon.ico">
    <link type="text/css" rel="stylesheet" href="styles/styles.css">
    
</head>
<body>

<header class="layout-header">
  
    <a href="./">
      <img
        src="https://avatars.githubusercontent.com/u/76977527?s=400"
        alt="@AppKu/StashKu"
      >
    </a>
  
  <h1><a href="./index.html">@AppKu/StashKu</a></h1>
  
  <h2>v1.0.46</h2>
  
  
  <ul class="meta-links">
    
    <li><a href="https://appku.com"><i class="bi bi-globe"></i></a></li>
    
    <li><a href="https://github.com/appku/stashku"><i class="bi bi-github"></i></a></li>
    
  </ul>
  
  <nav class="layout-nav">
    <ul class="nav-introduction">
      <li class="nav-item"><a href="./index.html">Introduction</a></li>
    </ul>
    <ul><li class="nav-heading">Tutorials</li><li class="nav-item"><a href="tutorial-Going Next-Level with Models.html">Going Next-Level with Models</a></li><li class="nav-item"><a href="tutorial-Requests_ DELETE.html">Requests: DELETE</a></li><li class="nav-item"><a href="tutorial-Requests_ GET.html">Requests: GET</a></li><li class="nav-item"><a href="tutorial-Requests_ OPTIONS.html">Requests: OPTIONS</a></li><li class="nav-item"><a href="tutorial-Requests_ PATCH.html">Requests: PATCH</a></li><li class="nav-item"><a href="tutorial-Requests_ POST.html">Requests: POST</a></li><li class="nav-item"><a href="tutorial-Requests_ PUT.html">Requests: PUT</a></li><li class="nav-item"><a href="tutorial-Requests_ Where .html">Requests: Where (Filters)</a></li><li class="nav-item"><a href="tutorial-Using the CLI.html">Using the CLI</a></li><li class="nav-item"><a href="tutorial-Using the Fetch Engine.html">Using the Fetch Engine</a></li><li class="nav-item"><a href="tutorial-Using the Memory Engine.html">Using the Memory Engine</a></li><li class="nav-item"><a href="tutorial-Writing Your Own Engine.html">Writing Your Own Engine</a></li><li class="nav-item"><a href="tutorial-Writing Your Own Middleware.html">Writing Your Own Middleware</a></li></ul><ul><li class="nav-heading">Classes</li><li class="nav-heading"><span class="nav-item-type type-class" title="class">C</span><span class="nav-item-name is-class"><a href="BaseEngine.html">BaseEngine</a></span></li><li class="nav-item"><span class="nav-item-type type-member" title="member">M</span><span class="nav-item-name is-member"><a href="BaseEngine.html#config">config</a></span></li><li class="nav-item"><span class="nav-item-type type-member" title="member">M</span><span class="nav-item-name is-member"><a href="BaseEngine.html#log">log</a></span></li><li class="nav-item"><span class="nav-item-type type-member" title="member">M</span><span class="nav-item-name is-member"><a href="BaseEngine.html#name">name</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="BaseEngine.html#configure">configure</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="BaseEngine.html#delete">delete</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="BaseEngine.html#destroy">destroy</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="BaseEngine.html#get">get</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="BaseEngine.html#options">options</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="BaseEngine.html#patch">patch</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="BaseEngine.html#post">post</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="BaseEngine.html#put">put</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="BaseEngine.html#resources">resources</a></span></li><li class="nav-heading"><span class="nav-item-type type-class" title="class">C</span><span class="nav-item-name is-class"><a href="DeleteRequest.html">DeleteRequest</a></span></li><li class="nav-item"><span class="nav-item-type type-member" title="member">M</span><span class="nav-item-name is-member"><a href="DeleteRequest.html#method">method</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="DeleteRequest.html#all">all</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="DeleteRequest.html#clear">clear</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="DeleteRequest.html#count">count</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="DeleteRequest.html#from">from</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="DeleteRequest.html#headers">headers</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="DeleteRequest.html#toJSON">toJSON</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="DeleteRequest.html#where">where</a></span></li><li class="nav-heading"><span class="nav-item-type type-class" title="class">C</span><span class="nav-item-name is-class"><a href="FetchEngine.html">FetchEngine</a></span></li><li class="nav-item"><span class="nav-item-type type-member" title="member">M</span><span class="nav-item-name is-member"><a href="FetchEngine.html#config">config</a></span></li><li class="nav-item"><span class="nav-item-type type-member" title="member">M</span><span class="nav-item-name is-member"><a href="FetchEngine.html#data">data</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="FetchEngine.html#configure">configure</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="FetchEngine.html#delete">delete</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="FetchEngine.html#get">get</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="FetchEngine.html#options">options</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="FetchEngine.html#patch">patch</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="FetchEngine.html#post">post</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="FetchEngine.html#put">put</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="FetchEngine.html#resources">resources</a></span></li><li class="nav-heading"><span class="nav-item-type type-class" title="class">C</span><span class="nav-item-name is-class"><a href="Filter.html">Filter</a></span></li><li class="nav-item"><span class="nav-item-type type-member" title="member">M</span><span class="nav-item-name is-member"><a href="Filter.html#.LOGIC">LOGIC</a></span></li><li class="nav-item"><span class="nav-item-type type-member" title="member">M</span><span class="nav-item-name is-member"><a href="Filter.html#.OP">OP</a></span></li><li class="nav-item"><span class="nav-item-type type-member" title="member">M</span><span class="nav-item-name is-member"><a href="Filter.html#dot">dot</a></span></li><li class="nav-item"><span class="nav-item-type type-member" title="member">M</span><span class="nav-item-name is-member"><a href="Filter.html#tree">tree</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="Filter.html#.and">and</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="Filter.html#.fromObject">fromObject</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="Filter.html#.isEmpty">isEmpty</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="Filter.html#.or">or</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="Filter.html#.parse">parse</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="Filter.html#.tmpl">tmpl</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="Filter.html#add">add</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="Filter.html#and">and</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="Filter.html#clone">clone</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="Filter.html#or">or</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="Filter.html#test">test</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="Filter.html#toJSON">toJSON</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="Filter.html#toString">toString</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="Filter.html#walk">walk</a></span></li><li class="nav-heading"><span class="nav-item-type type-class" title="class">C</span><span class="nav-item-name is-class"><a href="GetRequest.html">GetRequest</a></span></li><li class="nav-item"><span class="nav-item-type type-member" title="member">M</span><span class="nav-item-name is-member"><a href="GetRequest.html#method">method</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="GetRequest.html#clear">clear</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="GetRequest.html#count">count</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="GetRequest.html#distinct">distinct</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="GetRequest.html#from">from</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="GetRequest.html#headers">headers</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="GetRequest.html#one">one</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="GetRequest.html#properties">properties</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="GetRequest.html#skip">skip</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="GetRequest.html#sort">sort</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="GetRequest.html#take">take</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="GetRequest.html#toJSON">toJSON</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="GetRequest.html#where">where</a></span></li><li class="nav-heading"><span class="nav-item-type type-class" title="class">C</span><span class="nav-item-name is-class"><a href="Logger.html">Logger</a></span></li><li class="nav-item"><span class="nav-item-type type-member" title="member">M</span><span class="nav-item-name is-member"><a href="Logger.html#callback">callback</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="Logger.html#debug">debug</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="Logger.html#error">error</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="Logger.html#info">info</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="Logger.html#warn">warn</a></span></li><li class="nav-heading"><span class="nav-item-type type-class" title="class">C</span><span class="nav-item-name is-class"><a href="Main.html">Main</a></span></li><li class="nav-item"><span class="nav-item-type type-member" title="member">M</span><span class="nav-item-name is-member"><a href="Main.html#cmd">cmd</a></span></li><li class="nav-item"><span class="nav-item-type type-member" title="member">M</span><span class="nav-item-name is-member"><a href="Main.html#state">state</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="Main.html#configure">configure</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="Main.html#request">request</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="Main.html#utility">utility</a></span></li><li class="nav-heading"><span class="nav-item-type type-class" title="class">C</span><span class="nav-item-name is-class"><a href="MemoryEngine.html">MemoryEngine</a></span></li><li class="nav-item"><span class="nav-item-type type-member" title="member">M</span><span class="nav-item-name is-member"><a href="MemoryEngine.html#config">config</a></span></li><li class="nav-item"><span class="nav-item-type type-member" title="member">M</span><span class="nav-item-name is-member"><a href="MemoryEngine.html#data">data</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="MemoryEngine.html#configure">configure</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="MemoryEngine.html#delete">delete</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="MemoryEngine.html#get">get</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="MemoryEngine.html#options">options</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="MemoryEngine.html#patch">patch</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="MemoryEngine.html#post">post</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="MemoryEngine.html#put">put</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="MemoryEngine.html#resourceOf">resourceOf</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="MemoryEngine.html#resources">resources</a></span></li><li class="nav-heading"><span class="nav-item-type type-class" title="class">C</span><span class="nav-item-name is-class"><a href="ModelGenerator.html">ModelGenerator</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="ModelGenerator.html#.formatModelName">formatModelName</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="ModelGenerator.html#.formatPropName">formatPropName</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="ModelGenerator.html#.generateModelType">generateModelType</a></span></li><li class="nav-heading"><span class="nav-item-type type-class" title="class">C</span><span class="nav-item-name is-class"><a href="ModelUtility.html">ModelUtility</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="ModelUtility.html#.isValidType">isValidType</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="ModelUtility.html#.map">map</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="ModelUtility.html#.model">model</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="ModelUtility.html#.pk">pk</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="ModelUtility.html#.resource">resource</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="ModelUtility.html#.schema">schema</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="ModelUtility.html#.unmodel">unmodel</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="ModelUtility.html#.unmodelFilters">unmodelFilters</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="ModelUtility.html#.unmodelProperties">unmodelProperties</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="ModelUtility.html#.unmodelPropertyOmit">unmodelPropertyOmit</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="ModelUtility.html#.unmodelSorts">unmodelSorts</a></span></li><li class="nav-heading"><span class="nav-item-type type-class" title="class">C</span><span class="nav-item-name is-class"><a href="OptionsExporter.html">OptionsExporter</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="OptionsExporter.html#export">export</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="OptionsExporter.html#makePropertyJSDoc">makePropertyJSDoc</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="OptionsExporter.html#toJavascriptPropertyDefaultReference">toJavascriptPropertyDefaultReference</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="OptionsExporter.html#toJavaScriptString">toJavaScriptString</a></span></li><li class="nav-heading"><span class="nav-item-type type-class" title="class">C</span><span class="nav-item-name is-class"><a href="OptionsRequest.html">OptionsRequest</a></span></li><li class="nav-item"><span class="nav-item-type type-member" title="member">M</span><span class="nav-item-name is-member"><a href="OptionsRequest.html#method">method</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="OptionsRequest.html#all">all</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="OptionsRequest.html#clear">clear</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="OptionsRequest.html#from">from</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="OptionsRequest.html#headers">headers</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="OptionsRequest.html#toJSON">toJSON</a></span></li><li class="nav-heading"><span class="nav-item-type type-class" title="class">C</span><span class="nav-item-name is-class"><a href="PatchRequest.html">PatchRequest</a></span></li><li class="nav-item"><span class="nav-item-type type-member" title="member">M</span><span class="nav-item-name is-member"><a href="PatchRequest.html#method">method</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="PatchRequest.html#all">all</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="PatchRequest.html#clear">clear</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="PatchRequest.html#count">count</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="PatchRequest.html#headers">headers</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="PatchRequest.html#template">template</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="PatchRequest.html#to">to</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="PatchRequest.html#toJSON">toJSON</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="PatchRequest.html#where">where</a></span></li><li class="nav-heading"><span class="nav-item-type type-class" title="class">C</span><span class="nav-item-name is-class"><a href="PostRequest.html">PostRequest</a></span></li><li class="nav-item"><span class="nav-item-type type-member" title="member">M</span><span class="nav-item-name is-member"><a href="PostRequest.html#method">method</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="PostRequest.html#clear">clear</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="PostRequest.html#count">count</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="PostRequest.html#headers">headers</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="PostRequest.html#objects">objects</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="PostRequest.html#to">to</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="PostRequest.html#toJSON">toJSON</a></span></li><li class="nav-heading"><span class="nav-item-type type-class" title="class">C</span><span class="nav-item-name is-class"><a href="PutRequest.html">PutRequest</a></span></li><li class="nav-item"><span class="nav-item-type type-member" title="member">M</span><span class="nav-item-name is-member"><a href="PutRequest.html#method">method</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="PutRequest.html#clear">clear</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="PutRequest.html#count">count</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="PutRequest.html#headers">headers</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="PutRequest.html#objects">objects</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="PutRequest.html#pk">pk</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="PutRequest.html#to">to</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="PutRequest.html#toJSON">toJSON</a></span></li><li class="nav-heading"><span class="nav-item-type type-class" title="class">C</span><span class="nav-item-name is-class"><a href="RequestProcessor.html">RequestProcessor</a></span></li><li class="nav-item"><span class="nav-item-type type-member" title="member">M</span><span class="nav-item-name is-member"><a href="RequestProcessor.html#options">options</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="RequestProcessor.html#buildGet">buildGet</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="RequestProcessor.html#buildOptions">buildOptions</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="RequestProcessor.html#start">start</a></span></li><li class="nav-heading"><span class="nav-item-type type-class" title="class">C</span><span class="nav-item-name is-class"><a href="Response.html">Response</a></span></li><li class="nav-item"><span class="nav-item-type type-member" title="member">M</span><span class="nav-item-name is-member"><a href="Response.html#affected">affected</a></span></li><li class="nav-item"><span class="nav-item-type type-member" title="member">M</span><span class="nav-item-name is-member"><a href="Response.html#code">code</a></span></li><li class="nav-item"><span class="nav-item-type type-member" title="member">M</span><span class="nav-item-name is-member"><a href="Response.html#data">data</a></span></li><li class="nav-item"><span class="nav-item-type type-member" title="member">M</span><span class="nav-item-name is-member"><a href="Response.html#returned">returned</a></span></li><li class="nav-item"><span class="nav-item-type type-member" title="member">M</span><span class="nav-item-name is-member"><a href="Response.html#total">total</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="Response.html#.empty">empty</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="Response.html#one">one</a></span></li><li class="nav-heading"><span class="nav-item-type type-class" title="class">C</span><span class="nav-item-name is-class"><a href="RESTError.html">RESTError</a></span></li><li class="nav-item"><span class="nav-item-type type-member" title="member">M</span><span class="nav-item-name is-member"><a href="RESTError.html#code">code</a></span></li><li class="nav-item"><span class="nav-item-type type-member" title="member">M</span><span class="nav-item-name is-member"><a href="RESTError.html#data">data</a></span></li><li class="nav-item"><span class="nav-item-type type-member" title="member">M</span><span class="nav-item-name is-member"><a href="RESTError.html#innerError">innerError</a></span></li><li class="nav-heading"><span class="nav-item-type type-class" title="class">C</span><span class="nav-item-name is-class"><a href="Sort.html">Sort</a></span></li><li class="nav-item"><span class="nav-item-type type-member" title="member">M</span><span class="nav-item-name is-member"><a href="Sort.html#dir">dir</a></span></li><li class="nav-item"><span class="nav-item-type type-member" title="member">M</span><span class="nav-item-name is-member"><a href="Sort.html#property">property</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="Sort.html#.asc">asc</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="Sort.html#.desc">desc</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="Sort.html#.parse">parse</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="Sort.html#toString">toString</a></span></li><li class="nav-heading"><span class="nav-item-type type-class" title="class">C</span><span class="nav-item-name is-class"><a href="StashKu.html">StashKu</a></span></li><li class="nav-item"><span class="nav-item-type type-member" title="member">M</span><span class="nav-item-name is-member"><a href="StashKu.html#config">config</a></span></li><li class="nav-item"><span class="nav-item-type type-member" title="member">M</span><span class="nav-item-name is-member"><a href="StashKu.html#engine">engine</a></span></li><li class="nav-item"><span class="nav-item-type type-member" title="member">M</span><span class="nav-item-name is-member"><a href="StashKu.html#log">log</a></span></li><li class="nav-item"><span class="nav-item-type type-member" title="member">M</span><span class="nav-item-name is-member"><a href="StashKu.html#middleware">middleware</a></span></li><li class="nav-item"><span class="nav-item-type type-member" title="member">M</span><span class="nav-item-name is-member"><a href="StashKu.html#stats">stats</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="StashKu.html#.parseDelete">parseDelete</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="StashKu.html#.parseGet">parseGet</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="StashKu.html#.parseOptions">parseOptions</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="StashKu.html#.parsePatch">parsePatch</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="StashKu.html#.parsePost">parsePost</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="StashKu.html#.parsePut">parsePut</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="StashKu.html#.requestFromFile">requestFromFile</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="StashKu.html#.requestFromObject">requestFromObject</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="StashKu.html#configure">configure</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="StashKu.html#delete">delete</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="StashKu.html#destroy">destroy</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="StashKu.html#get">get</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="StashKu.html#http">http</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="StashKu.html#middlerun">middlerun</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="StashKu.html#model">model</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="StashKu.html#options">options</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="StashKu.html#patch">patch</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="StashKu.html#post">post</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="StashKu.html#put">put</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="StashKu.html#use">use</a></span></li><li class="nav-heading"><span class="nav-item-type type-class" title="class">C</span><span class="nav-item-name is-class"><a href="UtilityProcessor.html">UtilityProcessor</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="UtilityProcessor.html#start">start</a></span></li></ul><ul><li class="nav-heading">Modules</li><li class="nav-heading"><span class="nav-item-type type-module" title="module">M</span><span class="nav-item-name is-module"><a href="module-StringUtility.html">StringUtility</a></span></li></ul><ul><li class="nav-heading">Namespaces</li><li class="nav-heading"><span class="nav-item-type type-namespace" title="namespace">N</span><span class="nav-item-name is-namespace"><a href="CLI.html">CLI</a></span></li><li class="nav-heading"><span class="nav-item-type type-namespace" title="namespace">N</span><span class="nav-item-name is-namespace"><a href="Filtering.html">Filtering</a></span></li><li class="nav-heading"><span class="nav-item-type type-namespace" title="namespace">N</span><span class="nav-item-name is-namespace"><a href="Modeling.html">Modeling</a></span></li></ul><li class="nav-heading"><a href="global.html">Globals</a></li><li class="nav-item"><span class="nav-item-type type-typedef" title="typedef">T</span><span class="nav-item-name is-typedef"><a href="global.html#ConditionCallback">ConditionCallback</a></span></li><li class="nav-item"><span class="nav-item-type type-typedef" title="typedef">T</span><span class="nav-item-name is-typedef"><a href="global.html#Constructor">Constructor</a></span></li><li class="nav-item"><span class="nav-item-type type-typedef" title="typedef">T</span><span class="nav-item-name is-typedef"><a href="global.html#DeleteRequestCallback">DeleteRequestCallback</a></span></li><li class="nav-item"><span class="nav-item-type type-typedef" title="typedef">T</span><span class="nav-item-name is-typedef"><a href="global.html#GetRequestCallback">GetRequestCallback</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="global.html#HttpRequestLoader">HttpRequestLoader</a></span></li><li class="nav-item"><span class="nav-item-type type-member" title="member">M</span><span class="nav-item-name is-member"><a href="global.html#ISO8601Date">ISO8601Date</a></span></li><li class="nav-item"><span class="nav-item-type type-typedef" title="typedef">T</span><span class="nav-item-name is-typedef"><a href="global.html#LoggerCallback">LoggerCallback</a></span></li><li class="nav-item"><span class="nav-item-type type-member" title="member">M</span><span class="nav-item-name is-member"><a href="global.html#LOGIC_KEYS">LOGIC_KEYS</a></span></li><li class="nav-item"><span class="nav-item-type type-typedef" title="typedef">T</span><span class="nav-item-name is-typedef"><a href="global.html#MainState">MainState</a></span></li><li class="nav-item"><span class="nav-item-type type-typedef" title="typedef">T</span><span class="nav-item-name is-typedef"><a href="global.html#MemoryEngineConfiguration">MemoryEngineConfiguration</a></span></li><li class="nav-item"><span class="nav-item-type type-typedef" title="typedef">T</span><span class="nav-item-name is-typedef"><a href="global.html#MemoryRequestHeader">MemoryRequestHeader</a></span></li><li class="nav-item"><span class="nav-item-type type-typedef" title="typedef">T</span><span class="nav-item-name is-typedef"><a href="global.html#ModelNameResolveCallback">ModelNameResolveCallback</a></span></li><li class="nav-item"><span class="nav-item-type type-member" title="member">M</span><span class="nav-item-name is-member"><a href="global.html#OP_MAP">OP_MAP</a></span></li><li class="nav-item"><span class="nav-item-type type-typedef" title="typedef">T</span><span class="nav-item-name is-typedef"><a href="global.html#OptionsRequestCallback">OptionsRequestCallback</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="global.html#PackageLoader">PackageLoader</a></span></li><li class="nav-item"><span class="nav-item-type type-typedef" title="typedef">T</span><span class="nav-item-name is-typedef"><a href="global.html#ParserToken">ParserToken</a></span></li><li class="nav-item"><span class="nav-item-type type-typedef" title="typedef">T</span><span class="nav-item-name is-typedef"><a href="global.html#PatchRequestCallback">PatchRequestCallback</a></span></li><li class="nav-item"><span class="nav-item-type type-typedef" title="typedef">T</span><span class="nav-item-name is-typedef"><a href="global.html#PostRequestCallback">PostRequestCallback</a></span></li><li class="nav-item"><span class="nav-item-type type-typedef" title="typedef">T</span><span class="nav-item-name is-typedef"><a href="global.html#PutRequestCallback">PutRequestCallback</a></span></li><li class="nav-item"><span class="nav-item-type type-typedef" title="typedef">T</span><span class="nav-item-name is-typedef"><a href="global.html#SortToken">SortToken</a></span></li><li class="nav-item"><span class="nav-item-type type-function" title="function">F</span><span class="nav-item-name is-function"><a href="global.html#start">start</a></span></li><li class="nav-item"><span class="nav-item-type type-typedef" title="typedef">T</span><span class="nav-item-name is-typedef"><a href="global.html#StashKuConfiguration">StashKuConfiguration</a></span></li><li class="nav-item"><span class="nav-item-type type-typedef" title="typedef">T</span><span class="nav-item-name is-typedef"><a href="global.html#StashKuMiddleware">StashKuMiddleware</a></span></li><li class="nav-item"><span class="nav-item-type type-typedef" title="typedef">T</span><span class="nav-item-name is-typedef"><a href="global.html#StashKuMiddlewareCallback">StashKuMiddlewareCallback</a></span></li><li class="nav-item"><span class="nav-item-type type-typedef" title="typedef">T</span><span class="nav-item-name is-typedef"><a href="global.html#StashKuMiddlewareLogCallback">StashKuMiddlewareLogCallback</a></span></li><li class="nav-item"><span class="nav-item-type type-typedef" title="typedef">T</span><span class="nav-item-name is-typedef"><a href="global.html#StashKuModelConfiguration">StashKuModelConfiguration</a></span></li>
  </nav>
</header>


<main class="layout-main  layout-content--source">
  <div class="container">
    <p class="page-kind">source</p>
    <h1 class="page-title">engines/memory-engine.js</h1>
    



    

<section>
    <article>
        <pre id="source" class="source-page line-numbers"><code class="language-js">import DeleteRequest from '../requests/delete-request.js';
import GetRequest from '../requests/get-request.js';
import OptionsRequest from '../requests/options-request.js';
import PatchRequest from '../requests/patch-request.js';
import PostRequest from '../requests/post-request.js';
import PutRequest from '../requests/put-request.js';
import Response from '../response.js';
import RESTError from '../rest-error.js';
import Filter from '../filter.js';
import Logger from '../logger.js';
import ModelGenerator from '../modeling/model-generator.js';
import BaseEngine from './base-engine.js';
import Sort from '../sort.js';

const IS_BROWSER = !(typeof process !== 'undefined' &amp;&amp; process.version);

/**
 * Compares two objects.
 * @param {*} source - Object to compare.
 * @param {*} target - Another object to compare.
 * @returns {Boolean}
 * @ignore
 */
const objectEqual = (source, target) => {
    if (source === target) {
        return true;
    }
    for (let key in source) {
        if (source[key] !== target[key]) return false;
    }
    return true;
};

/**
 * @typedef MemoryEngineConfiguration
 * @property {Boolean} caseSensitive - Controls whether all resource names are stored in lower-case, and tracked
 * case-insensitively or not. By default this is unset in the configuration which will default to `false` internally
 * and allow it to be overridden by request headers. If set explicitly, the request header's `caseSensitive` flag 
 * will be ignored.
 * @property {Number} limit - Limits the maximum number of objects that can be stored in the memory engine per resource
 * name. If this limit is reached, POST requests will throw an error.
 */

/**
 * @typedef MemoryRequestHeader
 * @property {Boolean} caseSensitive - Instructs the memory storage engine to search for a resource by its lower-case
 * name (`false`) or regular-case (`true`). This will be ignored if the same flag (`caseSensitive`) is set on the 
 * memory storage configuration.
 */

/**
 * This StashKu engine is built-in and provides an in-memory data store with support for all StashKu RESTful actions
 * and operations. 
 */
class MemoryEngine extends BaseEngine {
    /**
     * Creates a new `MemoryEngine` instance.
     */
    constructor() {
        super('memory');

        /**
         * @type {Map.&lt;String, Array>}
         */
        this.data = new Map();

        /**
         * @type {MemoryEngineConfiguration}
         */
        this.config = {
            caseSensitive: null,
            limit: 0
        };
    }

    /**
     * @inheritdoc
     * @param {MemoryEngineConfiguration} config - The configuration object for the storage engine.
     */
    configure(config) {
        super.configure(config);
        let defaults = {
            caseSensitive: null,
            limit: 0
        };
        if (IS_BROWSER === false || (typeof process !== 'undefined' &amp;&amp; typeof process.env === 'object')) {
            let limit = parseInt(process.env.STASHKU_MEMORY_LIMIT);
            if (limit) {
                defaults.limit = limit;
            }
            if (typeof process.env.STASHKU_MEMORY_CASE_SENSITIVE === 'string') {
                defaults.caseSensitive = !!process.env.STASHKU_MEMORY_CASE_SENSITIVE.match(/^[tTyY1]/);
            }
        }
        this.config = Object.assign(defaults, config);
    }

    /**
     * @inheritdoc
     * @returns {Promise.&lt;Array.&lt;String>>}
     */
    async resources() {
        return Array.from(this.data.keys());
    }

    /**
     * Finds and adjusts the resource name of the given request with consideration to the case-sensitivity setting
     * on the storage engine or per-request.
     * @param {GetRequest | PatchRequest | PostRequest | PutRequest | OptionsRequest} request - The request to extract
     * the resource (target) name from.
     * @returns {String}
     * @protected
     */
    resourceOf(request) {
        let meta = request.metadata;
        let target = meta.from || meta.to;
        let caseSensitive = null;
        if (meta.headers &amp;&amp; meta.headers.has('caseSensitive')) {
            caseSensitive = meta.headers.get('caseSensitive');
        }
        if (typeof this.config.caseSensitive !== 'undefined' &amp;&amp; this.config.caseSensitive !== null) {
            caseSensitive = this.config.caseSensitive;
        }
        return caseSensitive ? target : target?.toLowerCase();
    }

    /**
     * @override
     * @throws 404 Error when the requested resource is has not been stored in memory.
     * @param {GetRequest} request - The GET request to send to the storage engine.
     * @returns {Promise.&lt;Response>} Returns the data objects from storage matching request criteria.
     */
    async get(request) {
        //validate
        await super.get(request);
        let meta = request.metadata;
        let from = this.resourceOf(request);
        if (this.data.has(from) === false) {
            throw new RESTError(404, `The requested resource "${meta.from}" was not found.`);
        }
        //find objects
        let matches = this.data.get(from);
        if (meta.where &amp;&amp; Filter.isEmpty(meta.where) === false) {
            matches = matches.filter(v => meta.where.test(v));
        }
        //ensure we have a new array with new object references (shallow copy).
        matches = matches.map(v => Object.assign({}, v));
        //apply distinct
        if (meta.distinct) {
            matches = matches.reduce((pv, cu, i, arr) => {
                let exists = pv.some((v) => objectEqual(cu, v));
                if (!exists) {
                    pv.push(cu);
                }
                return pv;
            }, []);
        }
        //perform sorts (no need to run if just counting)
        if (!meta.count &amp;&amp; meta.sorts &amp;&amp; meta.sorts.length) {
            const fieldSorter = (sorts) => (a, b) => sorts.map(s => {
                let dir = 1;
                if (s.dir === Sort.DIR.DESC) {
                    dir = -1;
                }
                return a[s.property] > b[s.property] ? dir : a[s.property] &lt; b[s.property] ? -(dir) : 0;
            }).reduce((p, n) => p ? p : n, 0);
            matches.sort(fieldSorter(meta.sorts));
        }
        //apply paging
        let total = matches.length; //save the total before reducing
        if (meta.skip &amp;&amp; meta.skip > 0) {
            matches.splice(0, meta.skip);
        }
        if (meta.take &amp;&amp; meta.take > 0) {
            matches = matches.slice(0, meta.take);
        }
        //handle count-only requests
        if (meta.count) {
            let res = new Response(null, total, 0, matches.length);
            return res;
        } else {
            //apply property limitations (if any)
            if (meta.properties &amp;&amp; meta.properties.length) {
                for (let m of matches) {
                    //delete any keys not in specified properties
                    Object.keys(m)
                        .filter(k => meta.properties.indexOf(k) &lt; 0)
                        .map(k => delete m[k]);
                }
            }
            return new Response(matches, total, 0, matches.length);
        }
    }

    /**
     * @override
     * @description
     * This will create the resource in memory if it does not already exist.
     * @param {PostRequest} request - The POST request to send to the storage engine.
     * @returns {Promise.&lt;Response>} Returns the data objects from storage that were created with the request criteria.
     */
    async post(request) {
        //validate
        await super.post(request);
        //process
        let meta = request.metadata;
        if (meta.objects &amp;&amp; meta.objects.length) {
            let to = this.resourceOf(request);
            if (this.data.has(to) === false) {
                this.data.set(to, []);
            }
            let resource = this.data.get(to);
            let storageClones = meta.objects.map(v => Object.assign({}, v));
            let responseClones = meta.objects.map(v => Object.assign({}, v));
            if (this.config &amp;&amp; this.config.limit &amp;&amp; resource.length + storageClones.length > this.config.limit) {
                throw new RESTError(400, `Cannot add additional objects to storage. The limit of ${this.config.limit} objects would be exceeded.`);
            }
            resource.push(...storageClones);
            if (meta.count) {
                return new Response(null, responseClones.length, responseClones.length, responseClones.length);
            } else {
                return new Response(responseClones, responseClones.length, responseClones.length, responseClones.length);
            }
        }
        return Response.empty();
    }

    /**
     * @override
     * @throws 404 Error when the requested resource is has not been stored in memory.
     * @param {PutRequest} request - The PUT request to send to the storage engine.
     * @returns {Promise.&lt;Response>} Returns the data objects from storage that were updated with the request criteria. This 
     * *__could potentially not__* exactly match the objects requested to be updated, as some may have been deleted from storage or
     * some may not match the primary key criteria.
     */
    async put(request) {
        //validate
        await super.put(request);
        let meta = request.metadata;
        let to = this.resourceOf(request);
        if (this.data.has(to) === false) {
            throw new RESTError(404, `The requested resource "${meta.to}" was not found.`);
        }
        //process
        if (meta.objects &amp;&amp; meta.objects.length) {
            let resource = this.data.get(to);
            let res = new Response();
            for (let o of meta.objects) {
                //find existing
                let record = resource.filter(r => meta.pk.every(k => r[k] === o[k]));
                if (record.length > 1) {
                    let values = meta.pk.map(k => o[k]);
                    throw new RESTError(409, `Multiple objects exist matching the specified primary keys ("${meta.pk.join('", "')}" with values "=${values.join('; =')}"). Only one to one matches are allowed.`);
                } else if (record.length === 1) {
                    //found a match, update and send in response...
                    Object.assign(record[0], o); //update record with properties/values from o.
                    res.data.push(Object.assign({}, record[0])); //store shallow clone in response so original is not affected.
                }
            }
            //send response
            res.total = res.data.length;
            res.affected = res.data.length;
            res.returned = res.data.length;
            if (meta.count) {
                res.data.length = 0;
            }
            return res;
        }
        return Response.empty();
    }
    /**
     * @override
     * @throws 404 Error when the requested resource is has not been stored in memory.
     * @param {PatchRequest} request - The PATCH request to send to the storage engine.
     * @returns {Promise.&lt;Response>} Returns a response with the total number of the objects affected in storage. No
     * data objects are typically returned with this request.
     */
    async patch(request) {
        //validate
        await super.patch(request);
        let meta = request.metadata;
        let to = this.resourceOf(request);
        if (this.data.has(to) === false) {
            throw new RESTError(404, `The requested resource "${meta.to}" was not found.`);
        }
        //find objects
        let matches = this.data.get(to);
        if (meta.where &amp;&amp; Filter.isEmpty(meta.where) === false) {
            matches = matches.filter(v => meta.where.test(v));
        }
        //perform update
        matches.map(m => Object.assign(m, meta.template));
        if (meta.count) {
            return new Response(null, matches.length, matches.length, matches.length);
        } else {
            let responseClones = matches.map(v => Object.assign({}, v));
            return new Response(responseClones, responseClones.length, responseClones.length, responseClones.length);
        }
    }

    /**
     * @override
     * @description
     * If the last item from memory is deleted, the resource is also deleted from memory (resulting in a 404 for the
     * resource until a new record is added under that resource name).
     * @throws 404 Error when the requested resource is has not been stored in memory.
     * @param {DeleteRequest} request - The DELETE request to send to the storage engine.
     * @returns {Promise.&lt;Response>} Returns the data objects from storage that were deleted with the request criteria.
     */
    async delete(request) {
        await super.delete(request); //validate
        let meta = request.metadata;
        let from = this.resourceOf(request);
        if (this.data.has(from) === false) {
            throw new RESTError(404, `The requested resource "${meta.from}" was not found.`);
        }
        //find objects
        let matches = this.data.get(from);
        if (meta.where &amp;&amp; Filter.isEmpty(meta.where) === false) {
            matches = matches.filter(v => meta.where.test(v));
        }
        //perform delete
        let storage = this.data.get(from);
        for (let m of matches) {
            let index = storage.findIndex(v => v === m);
            if (index >= 0) {
                storage.splice(index, 1);
            }
        }
        if (meta.count) {
            return new Response(null, matches.length, matches.length, matches.length);
        } else {
            return new Response(matches, matches.length, matches.length, matches.length);
        }
    }

    /**
     * @override
     * @throws 404 Error when the requested resource is has not been stored in memory.
     * @param {OptionsRequest} request - The OPTIONS request to send to the storage engine.
     * @returns {Promise.&lt;Response>} Returns a response with a single data object- the dynamically created model
     * configuration.
     */
    async options(request) {
        //validate
        await super.options(request);
        let meta = request.metadata;
        let resources = [];
        let modelTypes = [];
        if (request.metadata.from === '*') {
            resources.push(...this.data.keys());
        } else {
            resources.push(this.resourceOf(request));
        }
        for (let from of resources) {
            if (this.data.has(from) === false) {
                throw new RESTError(404, `The requested resource "${meta.from}" was not found.`);
            }
            let properties = new Map();
            let matches = this.data.get(from);
            //find properties - evaluate all records in resource
            for (let m of matches) {
                let keys = Object.keys(m);
                for (let k of keys) {
                    //build definition
                    let def = properties.get(k);
                    if (properties.has(k) === false) {
                        def = {
                            target: k,
                            type: m[k]?.constructor?.name || null,
                        };
                        properties.set(k, def);
                    }
                    //keep trying to discover the type if a value has not been previously found.
                    if (typeof def.type === 'undefined' || def.type === null) {
                        def.type = m[k]?.constructor?.name || null;
                    }
                }
            }
            //generate model type and return
            let mt = ModelGenerator.generateModelType(from, properties, { resource: from });
            modelTypes.push(mt);
        }
        return new Response(modelTypes, modelTypes.length, 0, modelTypes.length);
    }

}

export default MemoryEngine;</code></pre>
    </article>
</section>




  </div>
</main>

<footer class="layout-footer">
  <div class="container">
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.10</a> on Wed Apr 05 2023 12:05:15 GMT-0700 (Pacific Daylight Time)
  </div>
</footer>



<script src="scripts/prism.dev.js"></script>
</body>
</html>
